CREATE VIEW "DBO"."fctperformancemaster" AS select "fp"."dimProfile" AS "dimProfile","fp"."dimDate" AS "dimdate","fp"."dimTraffic" AS "dimTraffic",(case when isnull("dpp"."FormType") then 'No Form' else "dpp"."FormType" end) AS "FormType",max("fp"."Impressions") AS "impressions",max("fp"."AdClicks") AS "adclicks",max("fp"."AdCost") AS "adcost",sum((case when ("dpp"."ApplicationProgress" = 'Start') then "fpp"."Pageviews" else 0 end)) AS "StartPageViews",sum((case when ("dpp"."ApplicationProgress" = 'Start') then "fpp"."UniquePageviews" else 0 end)) AS "StartPageUniqueViews",sum((case when ("dpp"."ApplicationProgress" = 'Success') then "fpp"."Pageviews" else 0 end)) AS "SuccessPageViews",sum((case when ("dpp"."ApplicationProgress" = 'Success') then "fpp"."UniquePageviews" else 0 end)) AS "SuccessPageUniqueViews" from ((("fctperformance" "fp" join "dimtraffic" "dt" on(("fp"."dimTraffic" = "dt"."ID"))) left join "fctperformancepage" "fpp" on((("fp"."dimProfile" = "fpp"."dimProfile") and ("fp"."dimDate" = "fpp"."dimDate") and ("fp"."dimTraffic" = "fpp"."dimTraffic")))) left join "dimpagepath" "dpp" on(("fpp"."dimPagePath" = "dpp"."ID"))) where (("dpp"."ApplicationProgress" in ('start','success')) or isnull("dpp"."ID")) group by "fp"."dimProfile","fp"."dimDate","fp"."dimTraffic","dpp"."FormType"